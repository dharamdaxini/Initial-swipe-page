<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Swipe Intelligence</title>

<style>
/* ===== YOUR UI — UNCHANGED ===== */
:root {
    --color-bg: #f4f4f5;
    --color-card: #ffffff;
    --color-text: #18181b;
    --color-subtext: #71717a;
    --color-true: #22c55e;
    --color-false: #ef4444;
    --color-plausible: #eab308;
    --color-skip: #64748b;
    --shadow-card: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --font-stack: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
}

* { box-sizing:border-box; margin:0; padding:0; -webkit-tap-highlight-color:transparent; }

body {
    font-family: var(--font-stack);
    background-color: var(--color-bg);
    color: var(--color-text);
    height: 100svh;
    width: 100vw;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    user-select: none;
    overscroll-behavior: none;
}

.legend {
    display:flex;
    justify-content:space-around;
    padding:1rem;
    font-size:0.75rem;
    color:var(--color-subtext);
    text-transform:uppercase;
    letter-spacing:.05em;
    font-weight:600;
}

.legend-item .icon {
    display:block;
    text-align:center;
    font-size:1.2rem;
}

#app-container {
    flex:1;
    display:flex;
    justify-content:center;
    align-items:center;
    position:relative;
    max-width:480px;
    margin:0 auto;
    width:100%;
}

#card-stack {
    position:relative;
    width:90%;
    aspect-ratio:3/4;
    max-height:60svh;
}

.card {
    position:absolute;
    inset:0;
    background:var(--color-card);
    border-radius:16px;
    box-shadow:var(--shadow-card);
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    padding:2rem;
    text-align:center;
    touch-action:none;
    transform-origin:50% 100%;
    will-change:transform;
}

.card h3 {
    font-size:.85rem;
    text-transform:uppercase;
    color:var(--color-subtext);
    margin-bottom:1rem;
    letter-spacing:.1em;
}

.card p {
    font-size:1.25rem;
    line-height:1.5;
    font-weight:500;
}

.controls {
    display:flex;
    gap:.5rem;
    margin:1rem auto 1.5rem;
    width:90%;
}

.btn {
    flex:1;
    padding:12px 0;
    border-radius:8px;
    background:white;
    font-weight:600;
    font-size:.85rem;
    border:1px solid;
}

.btn-true { color:var(--color-true); border-color:var(--color-true); }
.btn-false { color:var(--color-false); border-color:var(--color-false); }
.btn-plausible { color:var(--color-plausible); border-color:var(--color-plausible); }
.btn-skip { color:var(--color-skip); border-color:var(--color-skip); }
</style>
</head>

<body>

<div class="legend">
    <div class="legend-item"><span class="icon">↑</span>True</div>
    <div class="legend-item"><span class="icon">→</span>Plausible</div>
    <div class="legend-item"><span class="icon">↓</span>False</div>
    <div class="legend-item"><span class="icon">←</span>Skip</div>
</div>

<div id="app-container">
    <div id="card-stack"></div>
</div>

<div class="controls">
    <button class="btn btn-skip">Skip</button>
    <button class="btn btn-false">False</button>
    <button class="btn btn-plausible">Plausible</button>
    <button class="btn btn-true">True</button>
</div>

<script>
/* ===== QUESTIONS — UNCHANGED ===== */
const QUESTIONS = [
{ id:"e1", topic:"Geography", type:"FACT", text:"The IMEC corridor is designed to connect India to Europe via the Middle East.", correct:"up", w:1 },
{ id:"e2", topic:"Energy", type:"FACT", text:"India has officially committed to Net Zero emissions by the year 2050.", correct:"right", w:1 },
{ id:"e3", topic:"Defense", type:"FACT", text:"The INS Vikrant is India's first indigenous aircraft carrier.", correct:"up", w:1 },
{ id:"m1", topic:"Semiconductors", type:"CONTEXT", text:"The Micron plant in Gujarat is primarily focused on packaging (ATMP), not full fabrication.", correct:"up", w:2 },
{ id:"m2", topic:"Finance", type:"TRAP", text:"UPI is now accepted for domestic payments in every G20 nation.", correct:"right", w:2 },
{ id:"m3", topic:"Space", type:"REASONING", text:"The Gaganyaan mission's primary delay was due to launch vehicle unavailability.", correct:"right", w:2 },
{ id:"h1", topic:"Trade", type:"TRAP", text:"India has finalized a full Free Trade Agreement (FTA) with the UK as of Jan 2026.", correct:"right", w:3 },
{ id:"h2", topic:"Nuclear", type:"FACT", text:"The PFBR at Kalpakkam achieved criticality in 2025.", correct:"up", w:3 },
{ id:"h3", topic:"Geopolitics", type:"REASONING", text:"India's non-alignment strategy has shifted to multi-alignment to secure lithium supply chains.", correct:"up", w:3 }
];

/* ===== GOOGLE SHEET LOGGER (INVISIBLE) ===== */
const SHEET_URL = "https://script.google.com/macros/s/AKfycbxW-via-zE7FWqGKNZsilySBncR3I_lLOXK83P8tymRLoi50VaSWNr7J4vHa8R2DRwE/exec";

/* ===== ENGINE ===== */
let index = 0;
const stack = document.getElementById("card-stack");

function render() {
    stack.innerHTML = "";
    if (!QUESTIONS[index]) return;

    const q = QUESTIONS[index];
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `<h3>${q.topic}</h3><p>${q.text}</p>`;
    stack.appendChild(card);

    enableSwipe(card, q);
}

function enableSwipe(card, q) {
    let startX=0, startY=0;

    card.addEventListener("pointerdown", e=>{
        startX=e.clientX; startY=e.clientY;
        card.setPointerCapture(e.pointerId);
    });

    card.addEventListener("pointermove", e=>{
        if (!card.hasPointerCapture(e.pointerId)) return;
        const dx=e.clientX-startX, dy=e.clientY-startY;
        card.style.transform=`translate(${dx}px,${dy}px) rotate(${dx*0.05}deg)`;
    });

    card.addEventListener("pointerup", e=>{
        const dx=e.clientX-startX, dy=e.clientY-startY;
        let dir = Math.abs(dx)>Math.abs(dy)
            ? (dx>50?"right":dx<-50?"left":null)
            : (dy<-50?"up":dy>50?"down":null);

        if (!dir) { card.style.transform=""; return; }

        logRow(q, dir);
        index++;
        render();
    });
}

function logRow(q, dir) {
    fetch(SHEET_URL,{
        method:"POST",
        mode:"no-cors",
        body:JSON.stringify({
            question_id:q.id,
            topic:q.topic,
            type:q.type,
            swipe:dir,
            correct:(dir===q.correct),
            weight:q.w,
            time:new Date().toISOString()
        })
    });
}

render();
</script>
</body>
</html>
