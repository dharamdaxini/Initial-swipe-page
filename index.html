<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>Swipe Intelligence Engine</title>

<style>
/* ===== YOUR CSS (UNCHANGED) ===== */
:root {
    --color-bg: #f4f4f5;
    --color-card: #ffffff;
    --color-text: #18181b;
    --color-subtext: #71717a;
    --color-true: #22c55e;
    --color-false: #ef4444;
    --color-plausible: #eab308;
    --color-skip: #64748b;
    --shadow-card: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
                   0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --font-stack: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    -webkit-tap-highlight-color: transparent;
}

body {
    font-family: var(--font-stack);
    background-color: var(--color-bg);
    color: var(--color-text);
    height: 100svh;
    width: 100vw;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    user-select: none;
    overscroll-behavior: none;
}

/* Legend */
.legend {
    display: flex;
    justify-content: space-around;
    padding: 1rem;
    font-size: 0.75rem;
    color: var(--color-subtext);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-weight: 600;
}

.legend-item .icon {
    display: block;
    text-align: center;
    font-size: 1.2rem;
}

/* App */
#app-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative;
    width: 100%;
    max-width: 480px;
    margin: 0 auto;
}

/* Cards */
#card-stack {
    position: relative;
    width: 90%;
    aspect-ratio: 3/4;
    max-height: 60svh;
}

.card {
    position: absolute;
    inset: 0;
    background: var(--color-card);
    border-radius: 16px;
    box-shadow: var(--shadow-card);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 2rem;
    text-align: center;
    touch-action: none;
    transform-origin: 50% 100%;
    will-change: transform;
}

.card h3 {
    font-size: 0.8rem;
    color: var(--color-subtext);
    margin-bottom: 1rem;
    letter-spacing: 0.1em;
}

.card p {
    font-size: 1.25rem;
    line-height: 1.5;
    font-weight: 500;
}

/* Controls */
.controls {
    display: flex;
    gap: 0.5rem;
    margin-top: 2rem;
    width: 90%;
    justify-content: space-between;
}

.btn {
    flex: 1;
    padding: 12px 0;
    border-radius: 8px;
    font-weight: 600;
    font-size: 0.8rem;
    background: white;
    border: 1px solid #ddd;
}
</style>
</head>

<body>

<div class="legend">
    <div class="legend-item"><span class="icon">↑</span>True</div>
    <div class="legend-item"><span class="icon">→</span>Plausible</div>
    <div class="legend-item"><span class="icon">↓</span>False</div>
    <div class="legend-item"><span class="icon">←</span>Skip</div>
</div>

<div id="app-container">
    <div id="card-stack"></div>
</div>

<script>
/* ===== QUESTIONS (UNCHANGED) ===== */
const QUESTIONS = [
    { id:"e1",topic:"Geography",type:"FACT",text:"The IMEC corridor is designed to connect India to Europe via the Middle East.",up:"True",down:"False",right:"Unsure",left:"Skip",correct:"up",w:1 },
    { id:"e2",topic:"Energy",type:"FACT",text:"India has officially committed to Net Zero emissions by the year 2050.",up:"True",down:"False",right:"2070",left:"Skip",correct:"right",w:1 },
    { id:"e3",topic:"Defense",type:"FACT",text:"The INS Vikrant is India's first indigenous aircraft carrier.",up:"True",down:"False",right:"Imported",left:"Skip",correct:"up",w:1 },
    { id:"m1",topic:"Semiconductors",type:"CONTEXT",text:"The Micron plant in Gujarat is primarily focused on packaging (ATMP), not full fabrication.",up:"True",down:"False",right:"Fab",left:"Skip",correct:"up",w:2 },
    { id:"m2",topic:"Finance",type:"TRAP",text:"UPI is now accepted for domestic payments in every G20 nation.",up:"True",down:"False",right:"Select Few",left:"Skip",correct:"right",w:2 },
    { id:"m3",topic:"Space",type:"REASONING",text:"The Gaganyaan mission's primary delay was due to launch vehicle unavailability.",up:"True",down:"False",right:"Safety Tests",left:"Skip",correct:"right",w:2 },
    { id:"h1",topic:"Trade",type:"TRAP",text:"India has finalized a full Free Trade Agreement (FTA) with the UK as of Jan 2026.",up:"Signed",down:"Stalled",right:"Draft Only",left:"Skip",correct:"right",w:3 },
    { id:"h2",topic:"Nuclear",type:"FACT",text:"The PFBR at Kalpakkam achieved criticality in 2025.",up:"True",down:"False",right:"Delayed",left:"Skip",correct:"up",w:3 },
    { id:"h3",topic:"Geopolitics",type:"REASONING",text:"India's non-alignment strategy has shifted to multi-alignment to secure lithium supply chains.",up:"Agree",down:"Disagree",right:"Unrelated",left:"Skip",correct:"up",w:3 }
];

/* ===== ENGINE STATE ===== */
let index = 0;
let startX = 0;
let startY = 0;
let dragging = false;
const THRESHOLD = 70;

const stack = document.getElementById("card-stack");

/* ===== RENDER ===== */
function render() {
    stack.innerHTML = "";
    if (index >= QUESTIONS.length) {
        alert("End of questions");
        return;
    }

    const q = QUESTIONS[index];
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `<h3>${q.topic} • ${q.type}</h3><p>${q.text}</p>`;
    stack.appendChild(card);
    bind(card);
}

/* ===== POINTER LOGIC ===== */
function bind(card) {
    card.addEventListener("pointerdown", e => {
        dragging = true;
        startX = e.clientX;
        startY = e.clientY;
        card.setPointerCapture(e.pointerId);
        card.style.transition = "none";
    });

    card.addEventListener("pointermove", e => {
        if (!dragging) return;
        const dx = e.clientX - startX;
        const dy = e.clientY - startY;
        card.style.transform =
            `translate(${dx}px,${dy}px) rotate(${dx * 0.05}deg)`;
    });

    card.addEventListener("pointerup", e => {
        if (!dragging) return;
        dragging = false;
        const dx = e.clientX - startX;
        const dy = e.clientY - startY;

        let dir = null;
        if (Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > THRESHOLD) {
            dir = dx > 0 ? "right" : "left";
        } else if (Math.abs(dy) > THRESHOLD) {
            dir = dy < 0 ? "up" : "down";
        }

        if (!dir) {
            card.style.transition = "transform 0.3s ease";
            card.style.transform = "translate(0,0)";
            return;
        }

        fly(card, dir);
    });
}

/* ===== COMMIT ===== */
function fly(card, dir) {
    const off = 800;
    let x = 0, y = 0;
    if (dir === "up") y = -off;
    if (dir === "down") y = off;
    if (dir === "left") x = -off;
    if (dir === "right") x = off;

    card.style.transition = "transform 0.35s ease";
    card.style.transform = `translate(${x}px,${y}px) rotate(${x * 0.1}deg)`;

    setTimeout(() => {
        index++;
        render();
    }, 300);
}

/* ===== INIT ===== */
render();
</script>

</body>
</html>
