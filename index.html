<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Strategic Convergence 2026</title>
    <style>
        :root {
            --color-bg: #f4f4f5;
            --color-card: #ffffff;
            --color-text: #18181b;
            --color-subtext: #71717a;
            --color-true: #22c55e;
            --color-false: #ef4444;
            --color-plausible: #eab308;
            --color-skip: #64748b;
            --shadow-card: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --font-stack: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            touch-action: none; /* DISABLES BROWSER SCROLLING GLOBALLY */
        }

        body {
            font-family: var(--font-stack);
            background-color: var(--color-bg);
            color: var(--color-text);
            height: 100svh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            user-select: none;
            -webkit-user-select: none;
            overscroll-behavior: none;
            position: fixed; /* Locks body in place */
        }

        /* --- LEGEND --- */
        .legend {
            display: flex;
            justify-content: space-around;
            padding: 1.5rem 1rem;
            font-size: 0.75rem;
            color: var(--color-subtext);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
            width: 100%;
            max-width: 480px;
            margin: 0 auto;
            pointer-events: none; /* Let clicks pass through */
        }

        .legend-item .icon {
            display: block;
            text-align: center;
            font-size: 1.2rem;
            margin-bottom: 4px;
        }

        /* --- APP CONTAINER --- */
        #app-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            width: 100%;
            max-width: 480px;
            margin: 0 auto;
            padding-bottom: 4rem;
        }

        /* --- CARD STACK --- */
        #card-stack {
            position: relative;
            width: 85%;
            aspect-ratio: 3/4;
            max-height: 65svh;
            touch-action: none;
        }

        .card {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--color-card);
            border-radius: 20px;
            box-shadow: var(--shadow-card);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            text-align: center;
            cursor: grab;
            transform-origin: 50% 100%;
            will-change: transform;
            /* Critical for mobile performance */
            backface-visibility: hidden; 
            transform: translateZ(0);
        }

        .card:active { cursor: grabbing; }

        .card h3 {
            font-size: 0.8rem;
            text-transform: uppercase;
            color: var(--color-subtext);
            margin-bottom: 1.5rem;
            letter-spacing: 0.15em;
            font-weight: 700;
            pointer-events: none; /* Ensure touches hit the card div */
        }

        .card p {
            font-size: 1.35rem;
            line-height: 1.6;
            font-weight: 500;
            color: var(--color-text);
            pointer-events: none; /* Ensure touches hit the card div */
        }

        /* --- SUMMARY VIEW --- */
        #summary-view {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100svh;
            background: var(--color-bg);
            z-index: 100;
            display: flex;
            flex-direction: column;
            padding: 2rem;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            overflow-y: auto;
            touch-action: pan-y; /* Re-enable scroll specifically for summary */
        }

        #summary-view.visible { opacity: 1; pointer-events: auto; }

        #summary-list { margin-bottom: 2rem; }

        .summary-item {
            background: white;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border-radius: 8px;
            font-size: 0.9rem;
            border-left: 5px solid transparent;
        }

        .confirmation-zone {
            height: 120px;
            margin-bottom: 2rem;
            position: relative;
        }

        #confirmation-card {
            width: 100%;
            height: 100%;
            background: #1e293b;
            color: white;
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            touch-action: none;
            position: absolute;
        }

        .confirm-legend {
            display: flex;
            justify-content: space-between;
            width: 80%;
            margin-top: 1rem;
            font-size: 0.75rem;
            opacity: 0.6;
            text-transform: uppercase;
        }

        .hidden { display: none; }
    </style>
</head>
<body>

    <header class="legend">
        <div class="legend-item"><span class="icon">↑</span> True</div>
        <div class="legend-item"><span class="icon">→</span> Plausible</div>
        <div class="legend-item"><span class="icon">↓</span> False</div>
        <div class="legend-item"><span class="icon">←</span> Skip</div>
    </header>

    <main id="app-container">
        <div id="card-stack" aria-live="polite"></div>
    </main>

    <section id="summary-view" class="hidden">
        <h2 style="font-size:1.2rem; margin-bottom:1rem; text-transform:uppercase; color:var(--color-subtext);">Session Summary</h2>
        <div id="summary-list"></div>
        <div class="confirmation-zone">
            <div id="confirmation-card">
                <p style="font-weight:600; font-size:1.1rem;">SWIPE TO FINALIZE</p>
                <div class="confirm-legend">
                    <span>← Cancel</span>
                    <span>Submit →</span>
                </div>
            </div>
        </div>
    </section>

    <script>
        const QUESTIONS = [
            { id: "q1_fact", type: "FACT RECALL", text: "The Dholera semiconductor fabrication facility is fully operational and shipping commercial wafers to domestic automotive partners.", correct: "up" },
            { id: "q2_context", type: "CONTEXT", text: "The integration of the Unified Logistics Interface Platform (ULIP) has successfully decoupled India's supply chain efficiency from crude oil price volatility.", correct: "right" },
            { id: "q3_causal", type: "REASONING", text: "Recent INR bilateral trade settlements with Gulf nations are driven primarily by a strategic mandate to bypass SWIFT, rather than organic economic demand.", correct: "right" },
            { id: "q4_global", type: "COMPARATIVE", text: "India’s Digital Public Infrastructure (DPI) export volume to the Global South now exceeds the value of its physical infrastructure lines of credit.", correct: "up" },
            { id: "q5_trap", type: "MISINFORMATION", text: "Following the 2025 review, the Indian Rupee was officially inducted into the IMF Special Drawing Rights (SDR) basket.", correct: "down" }
        ];

        const STATE = { IDLE: 'IDLE', DRAGGING: 'DRAGGING', ANIMATING: 'ANIMATING', SUMMARY: 'SUMMARY' };
        
        const APP = {
            currentState: STATE.IDLE,
            currentIndex: 0,
            answers: {},
            activeCard: null,
            startX: 0, startY: 0, 
            threshold: 100,
            timestampStart: new Date().toISOString()
        };

        const stackEl = document.getElementById('card-stack');
        const summaryView = document.getElementById('summary-view');
        const summaryList = document.getElementById('summary-list');
        const confirmCard = document.getElementById('confirmation-card');

        function init() {
            renderStack();
            document.addEventListener('touchmove', function(e) { e.preventDefault(); }, { passive: false });
        }

        function renderStack() {
            stackEl.innerHTML = '';
            [...QUESTIONS].reverse().forEach((q, index) => {
                const card = document.createElement('div');
                card.classList.add('card');
                card.style.zIndex = QUESTIONS.length - index;
                card.dataset.index = index;
                card.innerHTML = `<h3>${q.type}</h3><p>${q.text}</p>`;
                stackEl.appendChild(card);
            });
            updateTopCard();
        }

        function updateTopCard() {
            const topCard = stackEl.lastElementChild;
            if (topCard && APP.currentIndex < QUESTIONS.length) {
                APP.activeCard = topCard;
                bindCardEvents(topCard);
            } else {
                finishDeck();
            }
        }

        // --- ROBUST GLOBAL DRAG LOGIC ---

        function bindCardEvents(card) {
            // Remove old listeners to be safe
            card.onpointerdown = null;
            
            card.addEventListener('pointerdown', (e) => {
                if (APP.currentState !== STATE.IDLE) return;
                
                // Prevent browser default behavior immediately
                e.preventDefault();
                
                APP.currentState = STATE.DRAGGING;
                APP.startX = e.clientX;
                APP.startY = e.clientY;
                
                card.style.transition = 'none';

                // Bind to DOCUMENT to catch fast swipes that leave the card area
                document.addEventListener('pointermove', onPointerMove);
                document.addEventListener('pointerup', onPointerUp);
            });
        }

        function onPointerMove(e) {
            if (APP.currentState !== STATE.DRAGGING) return;
            e.preventDefault(); // Stop scrolling

            const deltaX = e.clientX - APP.startX;
            const deltaY = e.clientY - APP.startY;
            
            const rotate = deltaX * 0.05;
            
            // Move the active card
            APP.activeCard.style.transform = `translate(${deltaX}px, ${deltaY}px) rotate(${rotate}deg)`;
            
            updateVisualFeedback(deltaX, deltaY);
        }

        function updateVisualFeedback(dx, dy) {
            const absX = Math.abs(dx), absY = Math.abs(dy);
            let color = '';
            
            if (absY > absX) {
                color = dy < 0 ? 'var(--color-true)' : 'var(--color-false)';
            } else {
                color = dx > 0 ? 'var(--color-plausible)' : 'var(--color-skip)';
            }
            
            const opacity = Math.min((Math.max(absX, absY) / APP.threshold), 1);
            APP.activeCard.style.boxShadow = opacity > 0.1 ? `0 0 30px ${color}` : 'var(--shadow-card)';
        }

        function onPointerUp(e) {
            if (APP.currentState !== STATE.DRAGGING) return;
            
            // Clean up global listeners
            document.removeEventListener('pointermove', onPointerMove);
            document.removeEventListener('pointerup', onPointerUp);
            
            APP.currentState = STATE.ANIMATING;
            
            const deltaX = e.clientX - APP.startX;
            const deltaY = e.clientY - APP.startY;
            const absX = Math.abs(deltaX);
            const absY = Math.abs(deltaY);
            
            let decision = null;
            
            if (absY > absX && absY > APP.threshold) {
                decision = deltaY < 0 ? 'up' : 'down';
            } else if (absX > absY && absX > APP.threshold) {
                decision = deltaX > 0 ? 'right' : 'left';
            }
            
            decision ? commitSwipe(decision) : resetCard();
        }

        function resetCard() {
            APP.activeCard.style.transition = 'transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1), box-shadow 0.2s';
            APP.activeCard.style.transform = 'translate(0, 0) rotate(0)';
            APP.activeCard.style.boxShadow = 'var(--shadow-card)';
            setTimeout(() => APP.currentState = STATE.IDLE, 300);
        }

        function commitSwipe(direction) {
            const qId = QUESTIONS[APP.currentIndex].id;
            APP.answers[qId] = direction;
            
            let transX = 0, transY = 0;
            if (direction === 'up') transY = -1200;
            if (direction === 'down') transY = 1200;
            if (direction === 'left') transX = -1000;
            if (direction === 'right') transX = 1000;
            
            APP.activeCard.style.transition = 'transform 0.4s ease-in';
            APP.activeCard.style.transform = `translate(${transX}px, ${transY}px) rotate(${transX * 0.05}deg)`;
            
            setTimeout(() => {
                APP.activeCard.remove();
                APP.currentIndex++;
                APP.currentState = STATE.IDLE;
                updateTopCard();
            }, 350);
        }

        // --- SUMMARY LOGIC ---

        function finishDeck() {
            APP.currentState = STATE.SUMMARY;
            document.getElementById('app-container').style.display = 'none';
            document.querySelector('.legend').style.display = 'none';

            const mapping = { up: "ACCEPTED", down: "REJECTED", right: "PLAUSIBLE", left: "SKIPPED" };
            const colors = { up: "var(--color-true)", down: "var(--color-false)", right: "var(--color-plausible)", left: "var(--color-skip)" };
            
            summaryList.innerHTML = QUESTIONS.map(q => {
                const c = APP.answers[q.id];
                return `<div class="summary-item" style="border-left-color: ${colors[c]}"><strong>${q.type}</strong><br>${q.text}<br><span style="color:${colors[c]}; font-weight:700; font-size:0.8rem; margin-top:0.5rem; display:block;">${mapping[c]}</span></div>`;
            }).join('');
            
            summaryView.classList.remove('hidden');
            setTimeout(() => summaryView.classList.add('visible'), 50);
            initConfirmationSwipe();
        }

        function initConfirmationSwipe() {
            let startX = 0;
            confirmCard.addEventListener('pointerdown', (e) => {
                startX = e.clientX;
                confirmCard.setPointerCapture(e.pointerId);
                confirmCard.style.transition = 'none';
                
                confirmCard.onpointermove = (ev) => {
                    const dx = ev.clientX - startX;
                    confirmCard.style.transform = `translateX(${dx}px)`;
                    if (dx > 50) confirmCard.style.background = '#22c55e';
                    else if (dx < -50) confirmCard.style.background = '#ef4444';
                    else confirmCard.style.background = '#1e293b';
                };
                
                confirmCard.onpointerup = (ev) => {
                    const dx = ev.clientX - startX;
                    confirmCard.onpointermove = null;
                    confirmCard.onpointerup = null;
                    if (dx > 100) submitData();
                    else if (dx < -100) location.reload();
                    else {
                        confirmCard.style.transition = 'transform 0.3s ease';
                        confirmCard.style.transform = 'translateX(0)';
                        confirmCard.style.background = '#1e293b';
                    }
                };
            });
        }

        function submitData() {
            confirmCard.innerHTML = "<h3>SUBMITTED</h3>";
            confirmCard.style.background = "#22c55e";
            confirmCard.style.transform = "translateX(0)";
            confirmCard.onpointerdown = null; // Lock it
        }

        init();
    </script>
</body>
</html>
