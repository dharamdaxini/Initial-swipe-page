<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no">
    <title>VIA.STACK | MASTER LAB</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,700;1,400&family=Inter:wght@400;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/auto-render.min.js"></script>

    <style>
        :root {
            --bg: #000000;
            --card-bg: #111111;
            --border: #222222;
            --gold: #ffd600;
            --blue: #3498db;
            --font-serif: 'Crimson Text', serif;
            --font-sans: 'Inter', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
        }

        /* Physics & Safety Reset */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { 
            margin: 0; height: 100vh; background: var(--bg); color: #fff;
            font-family: var(--font-sans); overflow: hidden; position: fixed; width: 100%;
            user-select: none; -webkit-user-select: none; touch-action: none; 
        }

        /* --- THE SINGULARITY HUD --- */
        #header { width: 90%; margin: 35px auto 0; z-index: 100; position: relative; }
        .header-meta { display: flex; justify-content: space-between; font-family: var(--font-mono); font-size: 0.65rem; color: #555; letter-spacing: 2px; }
        .progress-track { width: 100%; height: 2px; background: #1a1a1a; margin-top: 10px; border-radius: 1px; overflow: hidden; }
        #progress-bar { height: 100%; background: var(--gold); width: 0%; transition: width 0.4s ease; }

        /* --- THE STACK --- */
        #stack { position: relative; width: 92%; max-width: 400px; height: 72vh; margin: 30px auto 0; perspective: 1200px; }
        .card { 
            position: absolute; width: 100%; height: 100%; background: var(--card-bg); 
            border-radius: 40px; border: 1px solid var(--border); padding: 40px; 
            display: flex; flex-direction: column; justify-content: center; 
            box-shadow: 0 30px 90px rgba(0,0,0,0.9); will-change: transform; cursor: grab; 
        }

        /* --- VISUAL PROTOCOL WRAPPER --- */
        .alch-card-visual {
            width: 100%;
            text-align: center;
            font-family: var(--font-serif);
            font-size: 1.6rem;
            line-height: 1.3;
            color: #f0f0f0;
            /* Prevents long text from breaking the UI */
            overflow-wrap: break-word;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* Swipe HUD Labels */
        .swipe-label {
            position: absolute; inset: 0; display: flex; align-items: center; justify-content: center;
            background: #000; color: #fff; font-weight: 900; font-size: 1.6rem; text-transform: uppercase;
            border-radius: 40px; z-index: 999; opacity: 0; pointer-events: none; transition: opacity 0.1s;
        }

        /* Logic Overlay */
        .overlay {
            position: absolute; inset: 0; background: #0d0d0d; z-index: 1100; padding: 40px;
            opacity: 0; pointer-events: none; border-radius: 40px; transition: opacity 0.3s ease;
            display: flex; flex-direction: column; justify-content: center;
        }
        .overlay.active { opacity: 1; pointer-events: auto; }
        .overlay-body { font-size: 1.1rem; line-height: 1.5; color: #bbb; font-family: var(--font-serif); font-style: italic; }

        #loader { position: fixed; inset: 0; background: #000; z-index: 5000; display: flex; align-items: center; justify-content: center; font-family: var(--font-mono); color: var(--gold); letter-spacing: 5px; font-size: 0.8rem; }
        
        .btn { width: 100%; padding: 18px; border-radius: 50px; border: none; background: #fff; color: #000; font-weight: 900; text-transform: uppercase; margin-top: 20px; }

        /* KaTeX Adjustment for Mobile Subscripts */
        .katex { font-size: 1.1em !important; }
    </style>
</head>
<body>

<div id="loader">VIA.STACK // SYSTEM_BOOT</div>

<div id="header">
    <div class="header-meta">
        <span id="id-display">PROTOCOL_V133.40</span>
        <span id="xp-display">000 XP</span>
    </div>
    <div class="progress-track">
        <div id="progress-bar"></div>
    </div>
</div>

<div id="stack"></div>

<div id="pdf-container" style="display:none;"></div>

</body>
</html>
