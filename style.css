:root { 
    /* COLOR SYSTEM */
    --bg: #000; 
    --card: #0d0d0d; 
    --gold: #ffd600; 
    --border: #1a1a1a;
    --ui-text: #444;
    --accent-dim: rgba(255, 214, 0, 0.15);

    /* TYPOGRAPHY STACK */
    --serif: 'Libre Baskerville', serif; 
    --ui: 'Outfit', sans-serif; 
    --code: 'JetBrains Mono', monospace;
}

/* RESET & GLOBAL */
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
body { 
    margin: 0; 
    height: 100vh; 
    background: var(--bg); 
    color: #fff; 
    font-family: var(--ui); 
    overflow: hidden; 
    touch-action: none; /* Prevents browser pull-to-refresh */
}

/* HEADER ARCHITECTURE */
#header { 
    width: 92%; 
    margin: calc(25px + env(safe-area-inset-top)) auto 0; 
    position: relative; 
    z-index: 100; 
}

.header-meta { 
    display: flex; 
    justify-content: space-between;
    font-family: var(--code); 
    font-size: 0.7rem; 
    color: var(--ui-text); 
    letter-spacing: 3px; 
    text-transform: uppercase; 
    font-weight: 900; 
}

/* THE PHYSICAL STACK ENGINE */
#stack { 
    position: relative; 
    width: 92%; 
    max-width: 420px; 
    height: 70vh; 
    margin: 30px auto 0; 
    perspective: 1200px; 
}

.card { 
    position: absolute; 
    width: 100%; 
    height: 100%; 
    background: var(--card); 
    border-radius: 32px; 
    border: 1px solid var(--border); 
    padding: 45px 30px; 
    display: flex; 
    flex-direction: column; 
    justify-content: center; 
    z-index: 5; 
    box-shadow: 0 40px 80px rgba(0,0,0,0.9);
    transition: filter 0.5s ease, opacity 0.5s ease, transform 0.4s cubic-bezier(0.19, 1, 0.22, 1); 
    will-change: transform, filter;
}

/* THE RIFT STATE (TRIGGERED ON SWIPE) */
.card.study-active { 
    filter: blur(18px) brightness(0.2); 
    opacity: 0.4; 
    transform: scale(0.88) translateY(45px) rotateX(-5deg); 
    pointer-events: none; 
}

.card-q { 
    font-family: var(--serif); 
    font-size: 1.7rem; 
    line-height: 1.45; 
    font-weight: 700; 
    text-align: center; 
    color: #f5f5f5; 
}

/* ANALYSIS DRAWER (BACKGROUND LAYER) */
.study-drawer { 
    position: absolute; 
    inset: 0; 
    padding: 40px 25px; 
    z-index: 10; 
    display: flex; 
    flex-direction: column; 
    opacity: 0; 
    visibility: hidden; 
    transform: translateY(30px) scale(0.95); 
    transition: all 0.6s cubic-bezier(0.19, 1, 0.22, 1); 
}

.study-drawer.active { 
    opacity: 1; 
    visibility: visible; 
    transform: translateY(0) scale(1); 
}

.meta-label { 
    font-family: var(--code); 
    font-size: 0.65rem; 
    color: #333; 
    letter-spacing: 5px; 
    margin-bottom: 30px; 
    text-transform: uppercase; 
}

/* OPTION MATRIX (TRIPLE VECTOR) */
.option-grid { 
    display: grid; 
    grid-template-columns: 1fr; 
    gap: 12px; 
    margin-bottom: 25px; 
}

.opt-item { 
    font-size: 1rem; 
    padding: 16px; 
    background: rgba(255,255,255,0.03); 
    border: 1px solid #222; 
    border-radius: 16px;
    font-family: var(--serif); 
    color: #bbb; 
    display: flex; 
    align-items: center; 
    transition: all 0.2s ease;
}

.opt-item span { 
    font-family: var(--code); 
    color: var(--gold); 
    font-size: 0.7rem; 
    margin-right: 18px; 
    font-weight: 900; 
}

/* TACTILE FEEDBACK */
.opt-item:active { 
    background: var(--gold); 
    color: #000; 
    border-color: var(--gold);
    transform: scale(0.97);
}

.opt-item:active span { 
    color: #000; 
}

/* EXPLANATION / PRINCIPLE FOOTER */
.explanation-text { 
    font-size: 1.25rem; 
    line-height: 1.5; 
    color: var(--gold); 
    font-family: var(--serif); 
    font-style: italic; 
    border-top: 1px solid #111; 
    padding-top: 25px; 
    margin-top: auto; 
    text-shadow: 0 0 15px var(--accent-dim);
}

/* GLOBAL SYSTEM LOADER */
#loader { 
    position: fixed; 
    inset: 0; 
    background: #000; 
    z-index: 5000; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    font-family: var(--code);
    font-weight: 900; 
    color: var(--gold); 
    letter-spacing: 8px; 
    font-size: 0.8rem;
}
